# WorkflowEngine

–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ + –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –ø–ª–µ–µ—Ä. –°–æ–µ–¥–∏–Ω—è–π—Ç–µ –±–ª–æ–∫–∏ –≤–º–µ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ —Å –ø–æ–º–æ—â—å—é Lua-—Å–∫—Ä–∏–ø—Ç–æ–≤.

## –ß—Ç–æ —ç—Ç–æ

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –ø—É—Ç—ë–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —É–∑–ª–æ–≤ –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –ø–ª–µ–µ—Ä –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: —Ä–∞–∑–±–∏—Ç—å –∏–≥—Ä–æ–≤—É—é –ª–æ–≥–∏–∫—É –Ω–∞ –±–ª–æ–∫–∏ (—É–∑–ª—ã), –∫–∞–∂–¥—ã–π –±–ª–æ–∫ ‚Äî —ç—Ç–æ Lua-—Å–∫—Ä–∏–ø—Ç, –±–ª–æ–∫–∏ –ø–µ—Ä–µ–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è:

- –ü–æ—à–∞–≥–æ–≤—ã—Ö –±–æ–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
- Idle/–∫–ª–∏–∫–µ—Ä –∏–≥—Ä
- –†–∞—Å—á—ë—Ç–∞ –Ω–∞–≤—ã–∫–æ–≤/–±–∞—Ñ—Ñ–æ–≤
- –ö–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤
- –õ—é–±–æ–π –ª–æ–≥–∏–∫–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–æ–π –∫–∞–∫ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

## –°–∫—Ä–∏–Ω—à–æ—Ç

<img width="1403" height="863" alt="image" src="https://github.com/user-attachments/assets/7201603f-72a7-4035-b66b-c1bc7106df32" />

https://github.com/user-attachments/assets/08793b5b-d584-44a1-b641-9e8912ce3061

## –°–∫–∞—á–∞—Ç—å

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑ [Releases](https://github.com/LegnaOS/workflow-game/releases):

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `WorkflowIDE-macos.zip` | macOS IDE —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ |
| `workflow_player` | –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –ø–ª–µ–µ—Ä |
| `scripts.zip` | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ |

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IDE

1. –°–∫–∞—á–∞–π—Ç–µ –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ `WorkflowIDE-macos.zip`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `workflow_editor`
3. –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ –±–ª–æ–∫—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Ö–æ–ª—Å—Ç
4. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –ø–æ—Ä—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
5. –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏
6. `Ctrl+S` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, `Ctrl+O` ‚Äî –æ—Ç–∫—Ä—ã—Ç—å

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏–≥—Ä—ã

1. –°–æ–∑–¥–∞–π—Ç–µ workflow –≤ IDE
2. –ù–∞–∂–º–∏—Ç–µ ¬´üì¶ –ü—É–±–ª–∏–∫–∞—Ü–∏—è¬ª –≤ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è:
   - –ü–∞–ø–∫–∞ `–ò–º—è–ò–≥—Ä—ã_publish/`
   - –ü–ª–µ–µ—Ä `workflow_player`
   - –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç `–ò–º—è–ò–≥—Ä—ã.lpack`

### –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ `workflow_player` –∏ `.lpack` –≤ –æ–¥–Ω—É –ø–∞–ø–∫—É
2. –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ `workflow_player`
3. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–≥—Ä –ø–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é –≤—ã–±–æ—Ä–∞

## –§–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤

| –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|------------|----------|------------|
| `.L` | –û—Ç–∫—Ä—ã—Ç—ã–π JSON | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |
| `.LZ` | AES-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | –ó–∞—â–∏—Ç–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ |
| `.lpack` | –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç | –ê–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ |

## –°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤

–ë–ª–æ–∫–∏ ‚Äî —ç—Ç–æ Lua-—Å–∫—Ä–∏–ø—Ç—ã. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –ø–∞–ø–∫—É `scripts/`, –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –≥–æ—Ä—è—á–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π.

```lua
return {
    meta = {
        id = "my.double",
        name = "–£–¥–≤–æ–µ–Ω–∏–µ",
        category = "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
        color = "#FF5722"
    },
    inputs = {
        { id = "value", name = "–í—Ö–æ–¥", type = "number", default = 0 }
    },
    outputs = {
        { id = "result", name = "–†–µ–∑—É–ª—å—Ç–∞—Ç", type = "number", default = 0 }
    },
    execute = function(self, inputs)
        return { result = inputs.value * 2 }
    end
}
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [docs/BLOCK_DEVELOPMENT_RU.md](docs/BLOCK_DEVELOPMENT_RU.md)

## –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

```
scripts/
‚îú‚îÄ‚îÄ lite/          # Lite RPG Idle-–∏–≥—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ hero       # –ì–µ—Ä–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ boss       # –ë–æ—Å—Å
‚îÇ   ‚îú‚îÄ‚îÄ weapon     # –û—Ä—É–∂–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ armor      # –ë—Ä–æ–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ skill      # –ù–∞–≤—ã–∫
‚îÇ   ‚îî‚îÄ‚îÄ gem_*      # –ö–∞–º–Ω–∏ (–∞—Ç–∞–∫–∞/–∫—Ä–∏—Ç/—É–∫–ª–æ–Ω–µ–Ω–∏–µ)
‚îú‚îÄ‚îÄ game/          # –ò–≥—Ä–æ–≤–æ–µ —è–¥—Ä–æ
‚îÇ   ‚îú‚îÄ‚îÄ character  # –ü–µ—Ä—Å–æ–Ω–∞–∂
‚îÇ   ‚îú‚îÄ‚îÄ monster    # –ú–æ–Ω—Å—Ç—Ä
‚îÇ   ‚îú‚îÄ‚îÄ attack     # –†–∞—Å—á—ë—Ç –∞—Ç–∞–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ logic/         # –õ–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ branch     # –£—Å–ª–æ–≤–Ω–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ compare    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ selector   # –°–µ–ª–µ–∫—Ç–æ—Ä
‚îú‚îÄ‚îÄ math/          # –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ add        # –°–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ multiply   # –£–º–Ω–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ calc       # –í—ã—Ä–∞–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ input/         # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ text_input # –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
‚îÇ   ‚îú‚îÄ‚îÄ password   # –ü–æ–ª–µ –ø–∞—Ä–æ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ button     # –ö–Ω–æ–ø–∫–∞
‚îî‚îÄ‚îÄ util/          # –£—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ splitter   # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    ‚îú‚îÄ‚îÄ merger     # –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ–ª—å
    ‚îî‚îÄ‚îÄ switch     # –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
```

## –°–±–æ—Ä–∫–∞

–¢—Ä–µ–±—É–µ—Ç—Å—è Rust 1.70+

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
cargo run

# –°–±–æ—Ä–∫–∞ IDE –∏ –ø–ª–µ–µ—Ä–∞
cargo build --release

# –†–µ–∑—É–ª—å—Ç–∞—Ç
target/release/workflow_engine  # IDE
target/release/workflow_player  # –ü–ª–µ–µ—Ä
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ main.rs           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ IDE
‚îú‚îÄ‚îÄ player.rs         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø–ª–µ–µ—Ä–∞
‚îú‚îÄ‚îÄ app.rs            # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ script/           # Lua-–¥–≤–∏–∂–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ parser.rs     # –ü–∞—Ä—Å–∏–Ω–≥ —Å–∫—Ä–∏–ø—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ registry.rs   # –†–µ–µ—Å—Ç—Ä –±–ª–æ–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ loader.rs     # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
‚îú‚îÄ‚îÄ workflow/         # –Ø–¥—Ä–æ workflow
‚îÇ   ‚îú‚îÄ‚îÄ graph.rs      # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä–∞—Ñ–∞
‚îÇ   ‚îú‚îÄ‚îÄ block.rs      # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ connection.rs # –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ package.rs    # –§–æ—Ä–º–∞—Ç –∏–≥—Ä–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ storage.rs    # –•—Ä–∞–Ω–∏–ª–∏—â–µ
‚îî‚îÄ‚îÄ ui/               # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI
    ‚îú‚îÄ‚îÄ canvas.rs     # –•–æ–ª—Å—Ç
    ‚îú‚îÄ‚îÄ block_widget.rs
    ‚îî‚îÄ‚îÄ connection_widget.rs
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Rust** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **egui/eframe** ‚Äî immediate mode GUI
- **mlua** ‚Äî Lua 5.4
- **aes/cbc** ‚Äî AES-128-CBC —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **serde** ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

